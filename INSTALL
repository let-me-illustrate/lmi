// INSTALL for "Let me illustrate...".
//
// Copyright (C) 2005 Gregory W. Chicares.
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License version 2 as
// published by the Free Software Foundation.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, write to the Free Software
// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
//
// http://savannah.nongnu.org/projects/lmi
// email: <chicares@cox.net>
// snail: Chicares, 186 Belle Woods Drive, Glastonbury CT 06033, USA

// $Id: INSTALL,v 1.6 2005-07-05 17:42:58 wboutin Exp $

[This version says only how to install and patch the required version
of cgicc and xmlwrapp, and how to install the required version of boost.
Other instructions will be added later.]

[It's clearest to validate commands, then copy and paste them here.
Once we've done that, it becomes trivial to turn this into a shell
script or a makefile--which is better than asking users to copy lines
from this file and paste them tediously into a shell. We'll want to
write everything as a command first (e.g. write a 'wget' command
instead of saying 'Go download some file'.]

* Choose a directory for third-party libraries

[Insert rationale for freezing particular versions of third-party
libraries--see
  http://boost.org/more/faq.htm
topic
  "How can the Boost libraries be used successfully for important projects?"
]

[I have simply used /usr/local/include/ . That's not appropriate for
others who have later versions of these libraries already installed in
that location. To accommodate their needs, I'll modify the makefiles
soon to support /opt/lmi/third-party/ as an alternative. When that's
done, maybe we'll find that best for everyone. For now at least, I'll
assume that, and write /opt/lmi/third-party/ in these instructions.]

* Install and patch cgicc-3.1.4

Download
  ftp://ftp.gnu.org/pub/gnu/cgicc/cgicc-3.1.4.tar.bz2
and
  http://savannah.nongnu.org/cgi-bin/viewcvs/*checkout*/lmi/lmi/cgicc-patch-gwc-20050217
to /tmp/ .

Validate:
  /tmp[0]$md5sum cgicc-3.1.4.tar.bz2  cgicc-patch-gwc-20050217
  6cb5153fc9fa64b4e50c7962aa557bbe  cgicc-3.1.4.tar.bz2
  245c51c9c9c9f2b33b93650bef5467bf  cgicc-patch-gwc-20050217

Extract archive:
  /tmp[0]$bzip2 -dk cgicc-3.1.4.tar.bz2
  /tmp[0]$tar -xf cgicc-3.1.4.tar

Apply required patch:
  /tmp[0]$/msys/1.0/bin/patch --strip=0 <cgicc-patch-gwc-20050217 # note 0
  patching file `cgicc-3.1.4/cgicc/CgiDefs.h'
  patching file `cgicc-3.1.4/cgicc/CgiEnvironment.cpp'
  patching file `cgicc-3.1.4/cgicc/CgiUtils.cpp'

Copy cgicc's header files to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/include/cgicc/
  /tmp[0]$cp --preserve cgicc-3.1.4/cgicc/*.h /opt/lmi/third-party/include/cgicc/

* Install and patch xmlwrapp-0.2.0

Download
  http://pmade.org/software/xmlwrapp/download/xmlwrapp-0.2.0.tar.gz
and
  http://savannah.nongnu.org/cgi-bin/viewcvs/*checkout*/lmi/lmi/xmlwrapp-patch-gwc-20050217
to /tmp/ .

Validate:
  /tmp[0]$md5sum xmlwrapp-patch-gwc-20050217 xmlwrapp-0.2.0.tar.gz
  69b6d8f00f7352e13ca7a68c4d6282c8  xmlwrapp-patch-gwc-20050217
  f142e8bc349597ecbaebb4a8e246b65a  xmlwrapp-0.2.0.tar.gz

Extract archive:
  /tmp[0]$gzip -d xmlwrapp-0.2.0.tar.gz
  /tmp[0]$tar -xf xmlwrapp-0.2.0.tar

Apply required patch:
  /tmp[0]$/msys/1.0/bin/patch --strip=0 <xmlwrapp-patch-gwc-20050217 # note 0
  patching file `xmlwrapp-0.2.0/include/xmlwrapp/event_parser.h'
  patching file `xmlwrapp-0.2.0/include/xmlwrapp/node.h'
  patching file `xmlwrapp-0.2.0/include/xmlwrapp/tree_parser.h'
  patching file `xmlwrapp-0.2.0/src/libxml/tree_parser.cxx'

Copy xmlwrapp's header files to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/include/xmlwrapp/
  /tmp[0]$cp --preserve xmlwrapp-0.2.0/include/xmlwrapp/*.h /opt/lmi/third-party/include/xmlwrapp/

Copy xmlwrapp's src files to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/src/libxml/
  /tmp[0]$cp --preserve xmlwrapp-0.2.0/src/libxml/* /opt/lmi/third-party/src/libxml/

* Install boost-1.31.0

Download
  http://prdownloads.sourceforge.net/boost/boost_1_31_0.tar.bz2
to /tmp/ .

Validate:
  /tmp[0]$md5sum boost_1_31_0.tar.bz2
  8cc183538eaa5cfc53d88d0e94bd2fd4  boost_1_31_0.tar.bz2

Extract archive:
  /tmp[0]$bzip2 -dk boost_1_31_0.tar.bz2
  /tmp[0]$tar -xf boost_1_31_0.tar

Copy boost header files to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/include/boost/
  /tmp[0]$pushd boost_1_31_0/boost/
  /tmp/boost/boost_1_31_0/boost[0]$/msys/1.0/bin/cp --force --parents --preserve --recursive * /c/opt/lmi/third-party/include/boost/

[WENDY--the ancient cp you're using won't do this without producing
tons of bogus diagnostics; alternatively, you could do this:

  /tmp/boost/boost_1_31_0/boost[0]$cp --force --parents --preserve --recursive * /opt/lmi/third-party/include/boost/ 2>/dev/null

but that would lose any meaningful diagnostics.

Something similar could be done for the source directory below.]

  /tmp/boost/boost_1_31_0/boost[0]$popd

Copy boost source files to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/src/boost_1_31_0
  /tmp[0]$pushd boost_1_31_0/
  /tmp[0]$/msys/1.0/bin/cp --force --parents --preserve --recursive * /c/opt/lmi/third-party/src/boost_1_31_0/
  /tmp/boost/boost_1_31_0[0]$popd

* Install libxml2-2.6.19

Download
  http://ftp.gnome.org/pub/GNOME/sources/libxml2/2.6/libxml2-2.6.19.tar.gz
to /tmp/ .

Validate:
  /tmp[0]$md5sum libxml2-2.6.19.tar.gz
  61587d43389a414fc2f5223b428e325e  libxml2-2.6.19.tar.gz

Extract archive:
  /tmp[0]$gzip -d libxml2-2.6.19.tar.gz
  /tmp[0]$tar -xf libxml2-2.6.19.tar

Build library with MSYS:
 mm39272@MM53451PA /c/tmp/libxml2-2.6.19
$ ./configure && make

Copy libxml header files to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/include/libxml/
  /tmp[0]$pushd libxml2-2.6.19/include/libxml/
  /tmp/libxml2-2.6.19/include/libxml[0]$/msys/1.0/bin/cp.exe --force --parents --preserve --recursive * /c/opt/lmi/third-party/include/libxml/
  /tmp/libxml2-2.6.19/include/libxml[0]$popd

Copy libxml libraries to the third-party hierarchy:
  /tmp[0]$mkdir -p /opt/lmi/third-party/bin /opt/lmi/third-party/lib
  /tmp[0]$pushd libxml2-2.6.19/.libs/
  /tmp/libxml2-2.6.19/.libs[0]$cp -p libxml2-2.dll c:/opt/lmi/third-party/bin/
  /tmp/libxml2-2.6.19/.libs[0]$cp -p libxml2.dll.a c:/opt/lmi/third-party/lib/
  /tmp/libxml2-2.6.19/.libs[0]$popd

* Install wx

...
[We'll ask Vadim for advice on specifying options.]

* Platform-specific instructions

No special instructions are needed for GNU/Linux: on that platform,
everything will just work.

* Platform: msw

On the msw platform, it is necessary to install a compiler, a shell,
and certain general-purpose utilities that GNU/Linux systems provide
by default.

* Install MinGW

Download
  http://prdownloads.sourceforge.net/mingw/MinGW-4.1.0.exe?download
to /tmp/ .

Validate:
  /tmp[0]$md5sum MinGW-4.1.0.exe
  08ed1853fec1440b0ef03f0e3a8682af  MinGW-4.1.0.exe

Install
  /tmp[0]$./MinGW-4.1.0.exe

If an earlier release of MinGW already exists then this discussion
is useful prior to installing the newer release:
  http://gcc.gnu.org/ml/gcc-patches/2004-06/msg00703.html

...
[perhaps cygwin should be mentioned, too]

* Install MSYS

Download
  http://prdownloads.sourceforge.net/mingw/MSYS-1.0.10.exe?download
to /tmp/ .

Validate:
  /tmp[0]$md5sum MSYS-1.0.10.exe
  da686e2c7b283385ef79d7b75afb609c  MSYS-1.0.10.exe

Install:
  /tmp[0]$./MSYS-1.0.10.exe

  ...
[perhaps cygwin should be mentioned, too]
[I assume the MSYS Developer Tool Kit isn't needed for installation
instructions, right?]

* Install zsh

...
[amol deshpande's port, because MSYS's bash is broken [explain why]]

[perhaps we should mention cygwin's 'sh', which is an Almquist shell;
it's tiny and simple, and testing it ensures that shell scripts and
shell commands in makefiles are extremely portable]

---------

Notes.

note 0: Wendy--I think our msw users have an ancient and defective
version of 'patch'. They should instead use the one in the current
MSYS distribution. Probably they should copy it over the defective
binary they already have. At any rate, we mustn't write
  /tmp[0]$/msys/1.0/bin/patch ...
in platform-independent installation instructions: it should say only
  /tmp[0]$patch ...

We can do that, but should it always be noted in this file?
