// INSTALL for "Let me illustrate...".
//
// Copyright (C) 2005, 2006, 2007 Gregory W. Chicares.
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License version 2 as
// published by the Free Software Foundation.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, write to the Free Software Foundation,
// Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
//
// http://savannah.nongnu.org/projects/lmi
// email: <chicares@cox.net>
// snail: Chicares, 186 Belle Woods Drive, Glastonbury CT 06033, USA

// $Id: INSTALL,v 1.24 2007-01-27 00:00:51 wboutin Exp $

[It's clearest to validate commands, then copy and paste them here.
Once we've done that, it becomes trivial to turn this into a shell
script or a makefile--which is better than asking users to copy lines
from this file and paste them tediously into a shell. We'll want to
write everything as a command first (e.g. write a 'wget' command
instead of saying 'Go download some file'.]

* Special directory for certain third-party libraries

[Insert rationale for freezing particular versions of third-party
libraries--see
  http://boost.org/more/faq.htm
topic
  "How can the Boost libraries be used successfully for important projects?"
]

[/usr/local/include/ would not be appropriate for others who have
later versions of these libraries already installed in that location.
To accommodate their needs, the makefiles look in /opt/lmi/third_party/
for third-party libraries that we build as collections of objects.]

* Install libxml2-2.6.19

Download
  http://ftp.gnome.org/pub/GNOME/sources/libxml2/2.6/libxml2-2.6.19.tar.bz2
to /tmp/ .

Validate:
  /tmp[0]$md5sum libxml2-2.6.19.tar.bz2
  ed581732d586f86324ec46e572526ede  libxml2-2.6.19.tar.bz2

Extract archive:
  /tmp[0]$bzip2 --decompress --keep libxml2-2.6.19.tar.bz2
  /tmp[0]$tar --extract --file libxml2-2.6.19.tar

Build library with MSYS:
  wboutin@OWNER /c/tmp/libxml2-2.6.19
  $ ./configure && make

Copy libxml header files to the third-party hierarchy:
  /tmp[0]$mkdir --parents /opt/lmi/third_party/include/libxml/
  /tmp[0]$pushd libxml2-2.6.19/include/libxml/
  /tmp/libxml2-2.6.19/include/libxml[0]$/msys/1.0/bin/cp.exe --force --parents --preserve --recursive * /c/opt/lmi/third_party/include/libxml/
  /tmp/libxml2-2.6.19/include/libxml[0]$popd

Copy libxml libraries to the third-party hierarchy:
  /tmp[0]$mkdir --parents /opt/lmi/third_party/bin /opt/lmi/third_party/lib
  /tmp[0]$pushd libxml2-2.6.19/.libs/
  /tmp/libxml2-2.6.19/.libs[0]$cp --parents libxml2-2.dll c:/opt/lmi/third_party/bin/
  /tmp/libxml2-2.6.19/.libs[0]$cp --parents libxml2.dll.a c:/opt/lmi/third_party/lib/
  /tmp/libxml2-2.6.19/.libs[0]$popd

* Install and patch mpatrol_1.4.8

Download
  http://www.cbmamiga.demon.co.uk/mpatrol/files/mpatrol_1.4.8.tar.gz
and
  http://sourceforge.net/tracker/download.php?group_id=19456&atid=319456&file_id=117735&aid=1112376
to /tmp/ .

Validate:
  /tmp[0]$md5sum mpatrol_1.4.8.tar.gz mpatrol-zero-byte-moves.tar.bz2
  ada423c49bc5bfa7c3e7a80a711c2a1a  mpatrol_1.4.8.tar.gz
  d8281af88b98f35212a851942158a9f6  mpatrol-zero-byte-moves.tar.bz2

Extract archives:
  /tmp[0]$gzip --decompress mpatrol_1.4.8.tar.gz
  /tmp[0]$tar --extract --file mpatrol_1.4.8.tar
  /tmp[0]$bzip2 --decompress --keep mpatrol-zero-byte-moves.tar.bz2
  /tmp[0]$tar --extract --file mpatrol-zero-byte-moves.tar

Apply required patch:
  /tmp[0]$patch --strip=0 <mpatrol/mpatrol-zero-byte-moves
  patching file `mpatrol/src/malloc.c'

That patch suppresses diagnostics for behavior that's actually
undefined according to C99 7.21.1/2, but wxWidgets relies on that
behavior being benign.

Download
  http://savannah.nongnu.org/cgi-bin/viewcvs/lmi/lmi/mpatrol-mingw-GNUmakefile
to /mpatrol/build/windows/ .

[This is specific to msw. We should give GNU/Linux commands too.]

Build mpatrol libraries:
  /tmp/mpatrol/build/windows[0]$path=(/usr/bin /MinGW/bin)
  /tmp/mpatrol/build/windows[0]$make --file=mpatrol-mingw-GNUmakefile

Install mpatrol libraries:
  /tmp/mpatrol/build/windows[0]$make --file=mpatrol-mingw-GNUmakefile install

* Install wx

The following options must be set to 1 in wx/setup.h (or using configure):
    wxUSE_DOC_VIEW_ARCHITECTURE
    wxUSE_MDI_ARCHITECTURE
    wxUSE_PRINTING_ARCHITECTURE
    wxUSE_STD_STRING

The following options must be set to 0 (all these are on by default):
    wxUSE_APPLE_IEEE
    wxUSE_LIBJPEG
    wxUSE_LIBTIFF
    wxUSE_GIF
    wxUSE_THREADS

* Platform-specific instructions

No special instructions are needed for GNU/Linux: on that platform,
everything will just work.

* Platform: msw

On the msw platform, it is necessary to install a compiler, a shell,
and certain general-purpose utilities that GNU/Linux systems provide
by default.

[perhaps cygwin should be mentioned, too]

* Install wget

Download
  http://umn.dl.sourceforge.net/sourceforge/mingw/wget-1.9.1-mingwPORT.tar.bz2
to /tmp/ .

Validate:
  /tmp[0]$md5sum wget-1.9.1-mingwPORT.tar.bz2
  5e320ff2ff5c81b67bb1e1aa87a27973  wget-1.9.1-mingwPORT.tar.bz2

Extract archive:
  /tmp[0]$bzip2 --decompress --keep wget-1.9.1-mingwPORT.tar.bz2
  /tmp[0]$tar --extract --file wget-1.9.1-mingwPORT.tar

Copy binary to path:
  /tmp[0]$cp --preserve wget-1.9.1/mingwPORT/wget.exe /usr/bin/
  /tmp[0]$cp --preserve wget-1.9.1/mingwPORT/wget.exe /msys/1.0/bin/

* Install zsh

Download
  ftp://ftp.blarg.net/users/amol/zsh/zsh.exe.gz
to /tmp/ .

Validate:
  /tmp[0]$md5sum zsh.exe
  4e642dd3439a2840727504bd637972b8  zsh.exe

Extract archive:
  /tmp[0]$gzip --decompress zsh.exe.gz

Copy binary to path:
  /tmp[0]$cp --preserve zsh.exe /usr/bin/

[amol deshpande's port, because MSYS's bash is broken [explain why]]

[perhaps we should mention cygwin's 'sh', which is an Almquist shell;
it's tiny and simple, and testing it ensures that shell scripts and
shell commands in makefiles are extremely portable]

